<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>BestConsecutiveAverageEarnings</title>
  <meta content="" name="description">

  <meta content="" name="keywords">

  <link href="../img/logo-excel-addin.png" rel="icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../css/style.css" rel="stylesheet">

</head>

<body>
    <section id="help" class="help">
        <div class="container">
            <div class="row">
                <div class="col-8"><h2>BestConsecutiveAverageEarnings function</h2></div>
                <div class="col-4 text-end"><h3>Actuarial Excel Addin</h3></div>
            </div>

            <p class="mt-5">The <span class="highlight">BestConsecutiveAverageEarnings function</span>, returns the <span class="highlight">NbYears</span> average 
                of best <span class="highlight">consecutive earnings</span> from the <span class="highlight">Earnings history</span>.  If
                 <span class="highlight">Service history</span> is provided, sum of service and corresponding earnings are considered up to <span class="highlight">NbYears</span>.</p>

            <p>If <span class="highlight">OutOf</span> is provided, then only the first <span class="highlight">OutOf</span> elements of Earnings history and Service history are used.</p>

            <p class="function-definition">See also <a href="BestAverageEarnings.html" target="_blank">BestAverageEarnings</a>.</p>

            <p class="function-definition">See also <a href="AverageSal.html" target="_blank">AverageSal</a> 
                for projecting future average earnings.</p>
                
            <p class="help-required">* : Required parameter</p>

            <div class="help-table function-definition">
                <div class="row help-table-title">
                    <div class="col-2">Parameters</div>
                    <div class="col-1">Default</div>
                    <div class="col-9">Description</div>
                </div>
                <div class="row">
                    <div class="col-2 help-param-required">NbYears *</div>
                    <div class="col-1">--</div>
                    <div class="col-9">Number of years of earnings included in the average, <span class="note">must be an integer</span></div>
                </div>
                <div class="row">
                    <div class="col-2">OutOf</div>
                    <div class="col-1">99</div>
                    <div class="col-9">Number of years considered, <span class="note">must be an integer</span></div>
                </div>
                <div class="row">
                    <div class="col-2 help-param-required">Earnings history *</div>
                    <div class="col-1">--</div>
                    <div class="col-9">Range of cells (contiguous) containing the earnings history from most recent to oldest.</div>
                </div>
                <div class="row">
                    <div class="col-2">Service history</div>
                    <div class="col-1">1, 1, 1, ...</div>
                    <div class="col-9">Range of cells (contiguous) containing the service history from most recent to oldest.  Each cell must contain a value from 0 to 1.</div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #1</span></div>
                    <div class="col-6"><span class="highlight">No Service history</div>
                </div>
                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>Earnings history = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p class="help-example-answer">BestConsecutiveAverageEarnings(NbYears, , Earnings history) returns 51329.20</p>
                    </div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #2</span></div>
                    <div class="col-6"><span class="highlight">With Service history</div>
                </div>
                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>Earnings history = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p>Service history = [0.95, 0.99, 0.98, 0.95, 0.95, 0.93, 0.93, 0.96]</p>
                        <p class="help-example-answer">BestConsecutiveAverageEarnings(NbYears, , Earnings history, Service history) returns 53549.04</p>
                    </div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #3</span></div>
                    <div class="col-6"><span class="highlight">With Service history and OutOf</div>
                </div>
                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>OutOf = 7</p>
                        <p>Earnings history = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p>Service history = [0.95, 0.99, 0.98, 0.95, 0.95, 0.93, 0.93, 0.96]</p>
                        <p class="help-example-answer">BestConsecutiveAverageEarnings(NbYears, OutOf, Earnings history, Service history) returns 43296.14</p>
                    </div>
                </div>
            </div>

        </div>
    </section>
</body>

</html>