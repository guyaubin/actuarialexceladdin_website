<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta name="description" content="How to use the AverageEarnings function" >

  <title>Actuarial Excel Addin: AverageEarnings function</title>

  <link href="../img/logo-excel-addin.png" rel="icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="../css/style.css" rel="stylesheet">

</head>

<body>
    <section id="help" class="help">
        <div class="container">
            <div class="row">
                <div class="col"><h1>AverageEarnings function</h1></div>
                <div class="col text-end"><h3>Actuarial Excel Addin</h3></div>
            </div>
            
            <a href="../../#tutorials" target="_blank">See the tutorial on Youtube</a>

            <p class="mt-5">The <span class="highlight">AverageEarnings function</span>, returns the <span class="highlight">Nb Years</span> average 
                of best earnings from the <span class="highlight">Earnings history</span>.  If <span class="highlight">Service history</span> is provided, annualized earnings are first ranked, then 
                weighted according to their respective service.  Sum of service and corresponding earnings are considered up to <span class="highlight">Nb Years</span>.  By default, best earnings do not need to be consecutive.</p>

            <p>If <span class="highlight">Out Of</span> is provided, then only the first <span class="highlight">Out Of</span> elements of Earnings history and Service history are used.</p>

            <p class="see-also">See also <a href="futureaverageearnings.html" target="_blank">FutureAverageEarnings</a> 
                for projecting future average earnings.</p>

            <p class="help-required mt-4">* : Required parameter</p>

            <div class="help-table function-definition">
                <div class="row help-table-title">
                    <div class="col-2">Parameters</div>
                    <div class="col-1">Default</div>
                    <div class="col-9">Description</div>
                </div>
                <div class="row">
                    <div class="col-2 help-param-required">Nb Years *</div>
                    <div class="col-1">--</div>
                    <div class="col-9">Number of years of earnings included in the average, <span class="note">fraction allowed</span></div>
                </div>
                <div class="row">
                    <div class="col-2 help-param-required">Earnings history *</div>
                    <div class="col-1">--</div>
                    <div class="col-9">Range of cells (contiguous) containing the earnings history from most recent to oldest.</div>
                </div>
                <div class="row">
                    <div class="col-2">Service history</div>
                    <div class="col-1">1, 1, 1, ...</div>
                    <div class="col-9">Range of cells (contiguous) containing the service history from most recent to oldest.  Each cell must contain a value from 0 to 1.</div>
                </div>
                <div class="row">
                    <div class="col-2">Best earnings</div>
                    <div class="col-1">True</div>
                    <div class="col-9">True/False for 'Best'/'Last' average earnings respectively.</div>
                </div>
                <div class="row">
                    <div class="col-2">Out Of</div>
                    <div class="col-1">0</div>
                    <div class="col-9">Number of years considered, <span class="note">must be an integer, 0 means all years considered</span></div>
                </div>
                <div class="row">
                    <div class="col-2">Consecutive</div>
                    <div class="col-1">False</div>
                    <div class="col-9">True, when best average comes from consecutive earnings.</div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #1</span></div>
                    <div class="col-6"><span class="highlight">No Service history</div>
                </div>
                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>EarningsHistory = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p class="help-example-answer">BestAverageEarnings(NbYears, , EarningsHistory) returns 53835.70</p>
                    </div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #2</span></div>
                    <div class="col-6"><span class="highlight">With Service history</span></div>
                </div>

                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>EarningsHistory = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p>ServiceHistory = [0.95, 0.99, 0.98, 0.95, 0.95, 0.93, 0.93, 0.96]</p>
                        <p class="help-example-answer">BestAverageEarnings(NbYears, , EarningsHistory, ServiceHistory) returns 55261.66</p>
                    </div>
                </div>
            </div>

            <br>
            <div class="help-example">
                <div class="row help-example-title">
                    <div class=col-2><span class="highlight">Example #3</span></div>
                    <div class="col-6"><span class="highlight">With Service history and Out Of</span></div>
                </div>

                <div class="row help-example-line">
                    <div class="col-2"></div>
                    <div class="col-10">
                        <p>NbYears = 5</p>
                        <p>OutOf = 7</p>
                        <p>EarningsHistory = [42750, 43718, 42307, 40404, 39843, 38539, 37860, 100000]</p>
                        <p>ServiceHistory = [0.95, 0.99, 0.98, 0.95, 0.95, 0.93, 0.93, 0.96]</p>
                        <p class="help-example-answer">BestAverageEarnings(NbYears, OutOf, EarningsHistory, ServiceHistory) returns 43296.14</p>
                    </div>
                </div>
            </div>

        </div>
    </section>
</body>

</html>